## 5.3 问题三模型的建立与求解

### 5.3.1 问题三分析

问题三将问题规模扩展到单机多弹场景，要求无人机FY1投放3枚烟幕弹对导弹M1实施干扰。相比单弹情况，多弹协同带来了新的挑战和机遇：

**挑战**：
- 决策空间维度激增：需要确定3个投放时刻和对应的起爆位置
- 时序约束：相邻投放间隔至少1秒
- 组合爆炸：多弹组合方案数量庞大

**机遇**：
- 时间覆盖延展：多个烟幕云团可接力遮蔽
- 空间布局优化：云团可在不同高度层形成立体遮蔽
- 冗余保障：单个云团失效不会导致完全失去遮蔽

### 5.3.2 多弹协同模型建立

#### 决策变量

设计分层决策变量结构：
- **飞行参数**：速度$v \in [70, 140]$ m/s，方向角$\theta \in [0, 2\pi)$
- **投放时序**：$\mathbf{D} = (D_1, D_2, D_3)$，满足$D_{i+1} - D_i \geq 1$秒
- **起爆时刻**：$\mathbf{E} = (E_1, E_2, E_3)$，其中$E_i = D_i + 3.6$秒

为简化问题，采用固定投放时序策略：$\mathbf{D} = (0, 1, 2)$秒，将优化重点放在飞行参数和起爆位置的协同优化上。

#### 多云团遮蔽模型

第$i$枚烟幕弹的起爆位置：
$$\mathbf{R}_{e,i} = \mathbf{U}_0 + v\hat{\mathbf{u}}(\theta) \cdot E_i + (0, 0, -\frac{1}{2}g(E_i - D_i)^2)$$

其中$\hat{\mathbf{u}}(\theta) = (\cos\theta, \sin\theta, 0)$为飞行方向单位向量。

第$i$个云团在时刻$t$的中心位置：
$$\mathbf{C}_i(t) = \begin{cases}
\text{undefined}, & t < E_i \\
\mathbf{R}_{e,i} + (0, 0, -v_{sink}(t - E_i)), & E_i \leq t \leq E_i + 20
\end{cases}$$

单个云团的遮蔽判定函数：
$$g_i(t) = d(\mathbf{C}_i(t), \overline{\mathbf{M}(t)\mathbf{T}}) - R$$

多云团联合遮蔽判定：
$$G(t) = \min_{i=1,2,3} g_i(t)$$

当$G(t) \leq 0$时，至少有一个云团实现遮蔽。

#### 目标函数

最大化总遮蔽时间：
$$J(v, \theta, \mathbf{E}) = \int_0^{t_{max}} \mathbb{I}[G(t) \leq 0] dt$$

通过数值方法计算遮蔽区间的并集：
$$\mathcal{I}_{total} = \bigcup_{i=1}^3 \mathcal{I}_i$$

其中$\mathcal{I}_i = \{t: g_i(t) \leq 0\}$为第$i$个云团的遮蔽区间集。

### 5.3.3 分层优化算法

采用分层优化策略，将高维优化问题分解为多个子问题：

#### 第一层：粗网格扫描

在缩减的参数空间进行网格搜索：
```
速度范围: v ∈ [138.8, 140.2]，步长0.05 m/s
角度范围: θ ∈ [178.2°, 179.8°]，步长0.05°
起爆时刻: 以0.2秒步长离散化
```

这一范围基于问题二的优化结果确定，集中在高概率区域。

#### 第二层：候选起爆点生成

对每个$(v, \theta)$组合和投放时刻$D_i$，生成候选起爆时刻集合：

```python
for E in range(D_i, 20.0, 0.2):
    计算起爆点坐标
    评估单弹遮蔽时间
    if 遮蔽时间 > 0:
        加入候选集
保留Top-32个最优候选
```

#### 第三层：组合优化

枚举三弹候选组合，计算并集遮蔽时间：

```python
for (E1, I1) in 候选集1:
    for (E2, I2) in 候选集2:
        for (E3, I3) in 候选集3:
            区间并集 = merge(I1, I2, I3)
            if 并集时长 > 当前最优:
                更新最优组合
```

区间合并算法采用扫描线方法，时间复杂度$O(n\log n)$。

#### 第四层：局部精化

##### 起爆时刻精化（坐标下降）

固定$(v, \theta)$，优化起爆时刻向量$\mathbf{E}$：

```python
步长 = 0.4秒
while 未收敛:
    for i in [1, 2, 3]:
        for 方向 in [+1, -1]:
            E'[i] = E[i] + 方向 * 步长
            if 改善 > 阈值:
                E = E'
                标记改善
    if 无改善:
        步长 *= 0.5
    if 步长 < 0.02:
        终止
```

##### 飞行参数精化

交替优化速度和角度：

```python
步长_v = 0.2 m/s, 步长_θ = 0.1°
for 迭代 in range(35):
    for 参数 in [v, θ]:
        for 方向 in [+1, -1]:
            更新参数
            重新搜索三弹组合
            精化起爆时刻
            if 改善:
                接受更新
    if 无改善:
        步长减半
    if 收敛:
        终止
```

### 5.3.4 数值实现细节

#### 时间离散化策略

- **粗扫描**：时间步长0.12秒，快速筛选
- **精细评估**：时间步长0.06秒，精确计算
- **边界求解**：容差$10^{-4}$秒，二分法最多64次迭代

#### 早期剪枝优化

```python
if min(g_values) > 8.0:  # 距离过远
    return 0.0, []  # 直接跳过
```

#### 并行化考虑

粗扫描阶段的957个$(v, \theta)$组合相互独立，可并行计算。实际实现中采用顺序计算以保证结果可重现性。

### 5.3.5 优化结果与分析

经过四层优化，得到最优投放策略：

**飞行参数**：
- 速度：140.0 m/s（达到速度上限）
- 方向：179.4°（接近负x轴方向）

**投放与起爆时序**：

| 烟幕弹 | 投放时刻(s) | 起爆时刻(s) | 起爆位置(m) | 单弹遮蔽(s) |
|--------|------------|------------|-------------|------------|
| 1号 | 0.0 | 3.6 | (17288.0, -14.0, 1736.5) | 2.08 |
| 2号 | 1.0 | 4.6 | (17148.0, -14.0, 1736.5) | 2.08 |
| 3号 | 2.0 | 5.6 | (17008.0, -14.0, 1736.5) | 2.08 |

**遮蔽效果**：
- 总遮蔽时长：**6.243秒**
- 遮蔽区间：约$[3.6, 9.8]$秒的连续覆盖

#### 策略特征分析

1. **等间距梯队布局**：三枚烟幕弹在x轴方向形成140米等间距梯队，确保云团下沉轨迹能够接力覆盖。

2. **时序精确协调**：1秒投放间隔配合140 m/s速度，使相邻云团在空间上形成最优重叠度。

3. **高度分层遮蔽**：利用重力下降和云团下沉的双重效应，在不同高度层形成立体遮蔽网。

4. **速度极限利用**：选择最大允许速度140 m/s，快速将烟幕弹部署到最优位置。

#### 相比单弹的改进

对比问题二的单弹最优解（4.59秒）：
- 遮蔽时长提升：**36%**（1.65秒）
- 覆盖连续性：从单区间扩展到完整连续覆盖
- 鲁棒性增强：多弹冗余提高了遮蔽可靠性

三弹协同的效率系数为$\eta = 6.243 / (3 \times 4.59) = 0.453$，表明存在一定的重叠损失，但整体效果仍显著优于单弹。

### 5.3.6 计算性能分析

- 粗扫描任务：957个组合
- 候选组合评估：约15,000个
- 局部精化迭代：16轮
- 总计算时间：约8秒
- 平均单次遮蔽评估：0.5毫秒

分层优化策略有效控制了计算复杂度，在可接受时间内获得了高质量解。