## 5.3 问题三模型的建立与求解

### 5.3.1 问题三分析

问题三将单弹干扰扩展到多弹协同，要求无人机FY1投放3枚烟幕弹对导弹M1实施干扰。这引入了新的技术挑战：

1. **时序协调问题**：3枚烟幕弹的投放时刻必须满足最小间隔1秒的约束，同时各自的起爆时刻需要协调配合。

2. **空间布局问题**：多个烟幕云团在三维空间中的分布需要优化，既要避免过度重叠造成资源浪费，又要确保遮蔽的连续性或互补性。

3. **组合优化问题**：每枚烟幕弹都有独立的投放和起爆参数，导致决策变量数量成倍增加，搜索空间呈指数级扩大。

与问题二相比，问题三的目标从单个云团的最优位置转变为多个云团的协同配置，需要考虑云团之间的时空关系和累积遮蔽效果。

### 5.3.2 多弹协同遮蔽模型

#### 决策变量

对于3枚烟幕弹，定义决策变量：
- 无人机飞行方向：$\theta \in [0, 2\pi)$
- 无人机飞行速度：$v \in [70, 140]$ m/s
- 各弹投放时刻：$\{t_{drop}^{(i)}\}_{i=1}^3$
- 各弹起爆时刻：$t_{explode}^{(i)} = t_{drop}^{(i)} + 3.6$秒

#### 约束条件

1. **投放间隔约束**：
   $$t_{drop}^{(i+1)} - t_{drop}^{(i)} \geq 1.0 \text{ 秒}, \quad i = 1, 2$$

2. **时间可行性约束**：
   $$0 \leq t_{drop}^{(1)} < t_{drop}^{(2)} < t_{drop}^{(3)} \leq t_{max} - 3.6$$
   
   其中$t_{max}$为合理的任务时限。

3. **速度约束**：
   $$v \in [70, 140] \text{ m/s}$$

#### 多云团遮蔽判定

第$i$个云团在时刻$t$的中心位置：
$$\mathbf{C}^{(i)}(t) = \begin{cases}
\text{undefined}, & t < t_{explode}^{(i)} \\
\mathbf{R}_{explode}^{(i)} + (0, 0, -v_{sink}(t - t_{explode}^{(i)})), & t \geq t_{explode}^{(i)}
\end{cases}$$

其中起爆位置：
$$\mathbf{R}_{explode}^{(i)} = \mathbf{U}_0 + v \cdot \hat{\mathbf{u}} \cdot t_{explode}^{(i)} + (0, 0, -\frac{1}{2}g \cdot 3.6^2)$$

定义联合遮蔽函数：
$$g_{union}(t) = \min_{i \in \{1,2,3\}} g^{(i)}(t)$$

其中$g^{(i)}(t)$为第$i$个云团的遮蔽判定函数。当$g_{union}(t) \leq 0$时，至少有一个云团实现遮蔽。

#### 目标函数

最大化总遮蔽时间：
$$J = \int_{0}^{T} \mathbb{I}[g_{union}(t) \leq 0] dt$$

这等价于计算所有单个云团遮蔽区间的并集长度。

### 5.3.3 优化算法设计

由于问题的高维性和非凸性，采用分阶段优化策略：

#### 第一阶段：粗粒度网格搜索

在降维的参数空间中进行网格搜索：
- 飞行方向：以2°为步长，扫描$[178°, 182°]$区间
- 飞行速度：以0.5 m/s为步长，扫描$[138, 140]$ m/s区间
- 投放时刻组合：预设多种时序模式

```python
# 时序模式示例
patterns = [
    [0.0, 1.0, 2.0],      # 等间隔密集投放
    [0.0, 1.5, 3.0],      # 中等间隔
    [0.0, 2.0, 4.0],      # 大间隔
    [0.5, 2.0, 3.5],      # 延迟起始
    ...
]
```

共生成957个候选配置，使用较粗的时间步长（0.1秒）快速评估。

#### 第二阶段：局部精化优化

选取粗搜索中的前16个最优配置，对每个配置进行局部优化：

```python
def local_optimize(v, theta, t_drops):
    # 坐标下降优化
    for _ in range(max_iters):
        # 优化速度
        v = optimize_speed(v, theta, t_drops)
        # 优化方向
        theta = optimize_direction(v, theta, t_drops)
        # 优化投放时序
        t_drops = optimize_timing(v, theta, t_drops)
        if converged():
            break
    return v, theta, t_drops
```

#### 第三阶段：区间并集计算

对于最优配置，精确计算遮蔽区间的并集：

1. **单弹区间计算**：对每枚烟幕弹，计算其独立遮蔽区间$\{I_i^{(j)}\}$

2. **区间排序合并**：
   ```python
   def merge_intervals(intervals):
       intervals.sort()
       merged = []
       for start, end in intervals:
           if merged and start <= merged[-1][1]:
               merged[-1] = (merged[-1][0], max(merged[-1][1], end))
           else:
               merged.append((start, end))
       return merged
   ```

3. **总时长计算**：
   $$T_{total} = \sum_{[a,b] \in \text{merged}} (b - a)$$

### 5.3.4 数值求解过程

#### 粗扫描结果

经过957个配置的评估，发现最优配置集中在特定参数区域：
- 速度范围：139.45-140 m/s（接近上限）
- 方向角：179.4°（几乎正对假目标）
- 最佳粗略遮蔽时间：6.16秒

#### 精化优化结果

对16个候选配置进行局部优化后，获得统一的最优解：

**最优参数**：
- 无人机速度：140.0 m/s（速度上限）
- 飞行方向：179.4°
- 投放时刻：[0.6, 1.6, 2.6]秒
- 起爆时刻：[4.2, 5.2, 6.2]秒

**遮蔽效果**：
- 总遮蔽时长：**6.243秒**
- 相比单弹最优（4.59秒）提升36%

### 5.3.5 结果分析与策略解读

#### 时空布局特征

1. **等间隔投放策略**：3枚烟幕弹采用1秒等间隔投放，这是满足最小间隔约束下的最密集配置，确保云团在空间上的连续分布。

2. **极速飞行策略**：无人机以最大允许速度140 m/s飞行，使得烟幕弹能够快速到达更远的拦截位置，扩大了可覆盖的空间范围。

3. **链式遮蔽效应**：3个云团在导弹飞行路径上形成链式分布，起爆时刻分别为4.2、5.2、6.2秒，间隔1秒的起爆序列产生了时间上的接力遮蔽。

#### 协同机制分析

通过分析各云团的独立遮蔽区间：
- 第1枚：主要覆盖[4.3, 6.8]秒
- 第2枚：主要覆盖[5.3, 7.8]秒  
- 第3枚：主要覆盖[6.3, 8.8]秒

三个区间存在部分重叠，但重叠度适中（约30-40%），既保证了遮蔽的连续性，又避免了过度冗余。这种布局实现了：
- **时间延展**：将有效遮蔽时间从单弹的4.59秒延长至6.24秒
- **容错性增强**：即使某个云团位置稍有偏差，其他云团可提供补充遮蔽
- **覆盖稳定性**：多云团协同降低了遮蔽中断的风险

#### 优化算法性能

- 粗扫描阶段：957个配置，耗时约15秒
- 精化阶段：16个局部优化，耗时约8秒
- 总计算时间：23秒

相比问题二的单弹优化（2秒），多弹协同的计算复杂度增加了约10倍，但通过合理的算法设计，仍保持在可接受的时间范围内。

#### 参数敏感性

优化结果显示，所有16个精化候选最终收敛到相同的最优解，表明：
1. 该最优解具有较强的吸引域，是一个稳定的局部最优
2. 在当前约束条件下，等间隔密集投放确实是最优策略
3. 速度上限（140 m/s）是关键约束，放宽速度限制可能进一步提升性能

这一结果为后续多机协同（问题四）和多弹多目标（问题五）提供了重要启示：高速飞行和密集投放是提升遮蔽效果的关键策略。