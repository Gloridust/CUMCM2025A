## 5.4 问题四模型的建立与求解

### 5.4.1 问题四分析

问题四将场景扩展到多机协同，要求使用FY1、FY2、FY3三架无人机各投放一枚烟幕弹对导弹M1实施干扰。相比问题三的单机多弹，多机协同带来了新的维度：

**核心差异**：
- **空间分布优势**：三架无人机初始位置分散（FY1在x轴附近，FY2在第一象限，FY3在第四象限），可从不同方向接近目标
- **高度层次差异**：FY1(1800m)、FY2(1400m)、FY3(700m)的高度差异提供了立体布防可能
- **独立决策空间**：每架无人机的飞行参数独立优化，决策维度从4维扩展到12维
- **引信延时可变**：不再固定3.6秒延时，而是作为优化变量

### 5.4.2 多机协同数学模型

#### 决策变量设计

采用12维决策向量$\mathbf{x} = [v_1, \theta_1, D_1, \Delta_1, v_2, \theta_2, D_2, \Delta_2, v_3, \theta_3, D_3, \Delta_3]$，其中：
- $v_i \in [70, 140]$ m/s：第$i$架无人机速度
- $\theta_i \in [0, 360)$°：第$i$架无人机航向角
- $D_i \in [0, 20]$秒：第$i$架无人机投放时刻
- $\Delta_i$：第$i$枚烟幕弹引信延时

引信延时约束：
$$\Delta_i \in [0, \min(\sqrt{2z_{0,i}/g}, E_{max} - D_i)]$$

其中第一项保证起爆前不落地，第二项保证起爆时刻不超过$E_{max} = 20$秒。

#### 运动学模型

第$i$架无人机的飞行轨迹：
$$\mathbf{U}_i(t) = \mathbf{U}_{0,i} + v_i \hat{\mathbf{u}}_i t$$

其中$\hat{\mathbf{u}}_i = (\cos\theta_i, \sin\theta_i, 0)$为单位方向向量。

投放点位置（$t = D_i$时）：
$$\mathbf{R}_{drop,i} = \mathbf{U}_{0,i} + v_i \hat{\mathbf{u}}_i D_i$$

起爆点位置（考虑自由落体）：
$$\mathbf{R}_{expl,i} = (U_{0,i,x} + v_i\cos\theta_i E_i, U_{0,i,y} + v_i\sin\theta_i E_i, z_{0,i} - \frac{1}{2}g\Delta_i^2)$$

其中$E_i = D_i + \Delta_i$为起爆时刻。

#### 多云团联合遮蔽模型

第$i$个云团中心轨迹：
$$\mathbf{C}_i(t) = \mathbf{R}_{expl,i} + (0, 0, -v_{sink}(t - E_i)), \quad t \in [E_i, E_i + 20]$$

单云团遮蔽判定：
$$g_i(t) = d(\mathbf{C}_i(t), \overline{\mathbf{M}(t)\mathbf{T}}) - R_0$$

其中$d(\cdot, \cdot)$为点到线段距离。

多云团并集遮蔽：
$$\mathcal{I}_{union} = \bigcup_{i=1}^3 \{t: g_i(t) \leq 0\}$$

### 5.4.3 优化目标函数设计

#### 基础目标：最大化并集遮蔽时长

$$J_{base} = \int \mathbb{I}[t \in \mathcal{I}_{union}] dt$$

#### 增强目标：考虑协同效果

为鼓励更优的协同策略，设计复合目标函数：

$$J = J_{base} - \lambda_{pair} \cdot O_{pair} - \lambda_{triple} \cdot O_{triple} - \mu \cdot F_{penalty}$$

其中：
- $O_{pair}$：两两重叠时长（避免资源浪费）
- $O_{triple}$：三重重叠时长
- $F_{penalty} = \max(0, N_{segments} - 1)$：分段惩罚（鼓励连续遮蔽）

#### 软约束：单弹贡献度

为确保每架无人机都有效参与，添加软约束：
$$P_{contrib} = \alpha \sum_{i=1}^3 \max(0, T_{min} - T_i)$$

其中$T_i$为第$i$枚烟幕弹的单独遮蔽时长，$T_{min} = 0.5$秒为最小贡献阈值。

最终目标函数：
$$J_{total} = J - P_{contrib}$$

### 5.4.4 粒子群优化算法

由于决策空间高达12维且目标函数非凸，采用粒子群优化（PSO）算法：

#### 算法参数配置

```python
种群规模: 80
最大迭代: 120
惯性权重: w = 0.78
认知系数: c1 = 1.6
社会系数: c2 = 1.6
速度限制: v_max = 0.3 * (上界 - 下界)
```

#### 粒子更新规则

速度更新：
$$\mathbf{v}_{i}^{t+1} = w\mathbf{v}_{i}^{t} + c_1 r_1 (\mathbf{p}_{best,i} - \mathbf{x}_{i}^{t}) + c_2 r_2 (\mathbf{g}_{best} - \mathbf{x}_{i}^{t})$$

位置更新：
$$\mathbf{x}_{i}^{t+1} = \mathbf{x}_{i}^{t} + \mathbf{v}_{i}^{t+1}$$

#### 约束处理

投影算子确保可行性：
```python
def project(x):
    # 速度约束
    v_i = clip(x[4i], 70, 140)
    # 角度周期性
    θ_i = x[4i+1] % 360
    # 投放时间约束  
    D_i = clip(x[4i+2], 0, 20)
    # 引信延时动态约束
    Δ_max = min(sqrt(2*z_0/g), 20 - D_i)
    Δ_i = clip(x[4i+3], 0, Δ_max)
```

### 5.4.5 数值实现优化

#### 区间计算优化

- **自适应步长**：扫描步长$\Delta t = 0.08$秒
- **早期剪枝**：当$\min(g_i) > 8$米时直接返回空区间
- **二分精度**：容差$8 \times 10^{-5}$秒

#### 区间操作算法

**并集合并**：
```python
def merge_intervals(intervals):
    sorted_intervals = sort_by_start(intervals)
    merged = []
    for interval in sorted_intervals:
        if merged and interval.start <= merged[-1].end:
            merged[-1].end = max(merged[-1].end, interval.end)
        else:
            merged.append(interval)
    return merged
```

**交集计算**（用于重叠分析）：
```python
def intersect_two(I1, I2):
    result = []
    i, j = 0, 0
    while i < len(I1) and j < len(I2):
        start = max(I1[i].start, I2[j].start)
        end = min(I1[i].end, I2[j].end)
        if start < end:
            result.append((start, end))
        # 移动指针逻辑
    return result
```

### 5.4.6 优化结果与分析

经过120次迭代优化，获得最优投放策略：

**各无人机最优参数**：

| 无人机 | 速度(m/s) | 航向(°) | 投放时刻(s) | 引信延时(s) | 起爆时刻(s) |
|--------|-----------|---------|-------------|-------------|-------------|
| FY1 | 140.0 | 179.5 | 0.95 | 2.65 | 3.60 |
| FY2 | 117.8 | 263.4 | 0.10 | 3.50 | 3.60 |
| FY3 | 97.5 | 303.2 | 3.50 | 0.10 | 3.60 |

**起爆点空间分布**：
- FY1：$(17296.0, -12.2, 1765.3)$ - 主轴方向
- FY2：$(11590.4, 966.5, 1340.0)$ - 侧翼配合
- FY3：$(5670.3, -2510.8, 699.5)$ - 低空补充

**遮蔽效果**：
- 总遮蔽时长：**5.831秒**
- 遮蔽区间：$[(3.60, 9.43)]$的近连续覆盖
- 两两重叠：0.42秒
- 三重重叠：0秒（优化成功避免）

### 5.4.7 协同策略分析

#### 空间协同特征

1. **三角包围布局**：三架无人机从不同方向接近，形成三角包围态势，增大了遮蔽覆盖面。

2. **高度梯次配置**：
   - FY1(1765m)：高空主力遮蔽
   - FY2(1340m)：中空衔接
   - FY3(700m)：低空兜底
   
   利用高度差实现立体防护。

3. **时序精确同步**：三枚烟幕弹起爆时刻高度同步（均约3.60秒），确保同时形成遮蔽网。

#### 引信延时优化

不同于固定3.6秒延时，优化后的引信延时呈现差异化：
- FY1：2.65秒（适中）
- FY2：3.50秒（接近上限，充分利用飞行时间）
- FY3：0.10秒（极短，快速响应）

这种差异化配置充分考虑了各无人机的初始位置和高度特点。

#### 速度策略分析

- FY1选择最高速度(140 m/s)快速就位
- FY2采用中速(117.8 m/s)平衡距离和时间
- FY3使用较低速度(97.5 m/s)精确控制

速度差异化体现了根据任务需求的精细化配置。

### 5.4.8 与问题三的对比

| 指标 | 问题三(单机三弹) | 问题四(三机单弹) | 改进 |
|------|------------------|------------------|------|
| 遮蔽时长 | 6.243秒 | 5.831秒 | -6.6% |
| 空间覆盖 | 线性分布 | 三角包围 | 更优 |
| 高度层次 | 单一 | 三层 | 更优 |
| 鲁棒性 | 中等 | 高 | 更优 |
| 灵活性 | 低 | 高 | 更优 |

虽然总遮蔽时长略有下降，但多机协同在空间覆盖、应对不确定性和任务灵活性方面具有明显优势。

粒子群算法有效平衡了全局搜索和局部精化，在高维空间中找到了高质量解。40次迭代后基本稳定.