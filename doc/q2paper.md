## 5.2 问题二模型的建立与求解

### 5.2.1 问题二分析

问题二要求在问题一的基础上进行优化，确定无人机FY1的最优飞行策略，包括飞行方向、速度、投放点和起爆点，使得单枚烟幕弹的遮蔽时间最大化。这是一个典型的非线性优化问题，决策变量包含连续的时空参数，目标函数具有非凸特性。

与问题一的固定方案相比，问题二的自由度大幅增加：
- 无人机飞行方向：360°范围内任意方向
- 无人机飞行速度：70-140 m/s连续区间
- 投放时刻：受起爆时间约束的连续变量
- 起爆位置：三维空间中的连续点

这些参数相互耦合，共同决定了烟幕云团的时空轨迹与导弹-目标视线的交互关系。

### 5.2.2 优化模型的建立

#### 参数化表示

为简化优化问题，采用极坐标参数化方案。设优化变量为：
- $t_e$：起爆时刻（从任务开始计时）
- $\theta$：无人机飞行方向角（相对于x轴正向）
- $d$：无人机从初始位置到起爆点的水平飞行距离

起爆位置可表示为：
$$\mathbf{R}_e = (U_{0x} + d\cos\theta, U_{0y} + d\sin\theta, U_{0z} - \frac{1}{2}gt_f^2)$$

其中$t_f = 3.6$秒为投放到起爆的固定延时。

#### 约束条件

1. **时间约束**：
   $$t_e \in [t_f, t_{max}]$$
   其中$t_{max} = 20$秒为合理的最晚起爆时间。

2. **速度约束**：
   $$v_{uav} = \frac{d}{t_e} \in [70, 140] \text{ m/s}$$
   
   等价于距离约束：
   $$d \in [70t_e, 140t_e]$$

3. **角度约束**：
   $$\theta \in [0, 2\pi)$$

#### 目标函数

目标函数定义为总遮蔽时间：
$$J(t_e, \theta, d) = \int_{t_e}^{t_e+20} \mathbb{I}[g(t; t_e, \theta, d) \leq 0] dt$$

其中$\mathbb{I}[\cdot]$为指示函数，$g(t)$为遮蔽判定函数：
$$g(t) = \max_{Q \in \partial\Omega} d(\mathbf{C}(t), \overline{\mathbf{M}(t)Q}) - R_{smoke}$$

$\partial\Omega$表示真目标圆柱体表面，$\mathbf{C}(t)$为云团中心轨迹，$d(\cdot, \cdot)$为点到线段距离。

### 5.2.3 数值优化算法

由于目标函数的非凸性和不连续性，采用混合优化策略：

#### 第一阶段：全局搜索

使用蒙特卡洛随机采样生成500个初始解：
```
for i = 1 to 500:
    t_e ~ Uniform(3.6, 20)
    θ ~ Uniform(0, 2π)  
    d ~ Uniform(70*t_e, 140*t_e)
    评估 J(t_e, θ, d)
```

这一阶段使用较粗的数值精度（时间步长0.10秒）快速评估，筛选出前5个最优种子解。

#### 第二阶段：局部精化

对每个优质种子解，采用坐标下降算法进行局部优化：

```
初始化步长: Δt = 0.3, Δθ = 1°, Δd = 60
while 未收敛:
    for 参数 in [t_e, θ, d]:
        for 方向 in [+1, -1]:
            计算候选解的目标函数值
            if 改善超过阈值:
                更新参数
                标记改善
    if 无改善:
        步长减半: Δ *= 0.5
    if 步长 < 最小阈值:
        终止
```

坐标下降算法的关键参数：
- 初始步长：时间0.3秒，角度1°，距离60米
- 最小步长：时间0.02秒，角度0.05°，距离2米
- 最大迭代：120次

#### 第三阶段：精确评估

对最优解进行高精度数值评估：
- 扫描步长：0.015秒
- 边界容差：$2 \times 10^{-5}$
- 二分法迭代：最多80次

#### 第四阶段：超精细验证

最终使用超高精度参数验证结果：
- 扫描步长：0.008秒
- 边界容差：$8 \times 10^{-6}$

### 5.2.4 事件驱动的遮蔽区间计算

遮蔽区间的精确计算采用事件驱动方法：

1. **粗扫描定位**：以固定步长扫描时间轴，记录$g(t)$的符号变化点

2. **二分法精化**：对每个符号变化区间$[t_i, t_{i+1}]$，使用二分法求解$g(t)=0$的精确时刻：
   $$t^* = \text{Bisection}(g, t_i, t_{i+1}, \epsilon)$$

3. **区间构建**：根据零点序列和函数符号，构建遮蔽区间集合$\{[a_k, b_k]\}$

4. **总时长计算**：
   $$T_{total} = \sum_k (b_k - a_k)$$

### 5.2.5 优化结果分析

经过四阶段优化，获得最优解：

**最优参数**：
- 起爆时刻：$t_e^* = 4.201$秒
- 飞行方向：$\theta^* = 3.126$弧度（约179.2°）
- 飞行距离：$d^* = 504.1$米
- 无人机速度：$v^* = 120.006$ m/s

**关键位置**：
- 投放点：$(17727.854, 1.125, 1800.0)$
- 起爆点：$(17295.885, 7.864, 1736.496)$

**遮蔽效果**：
- 总遮蔽时长：**4.59秒**
- 遮蔽区间：$[4.26, 8.85]$秒

相比问题一的固定方案（1.39秒），优化后的遮蔽时间提升了**230%**。

#### 优化策略分析

最优解呈现以下特征：

1. **提前起爆策略**：起爆时刻选择在4.201秒，显著早于问题一的5.1秒。这使得烟幕云团能在导弹接近时已经处于有利位置。

2. **精确速度控制**：无人机速度选择120.006 m/s，接近速度区间的中上水平，平衡了快速到达指定位置和保持飞行稳定性的需求。

3. **横向偏移补偿**：飞行方向略微偏离正负x轴（偏移约0.8°），产生小幅y方向位移（7.864米），这种微调优化了云团与导弹视线的相对几何关系。

4. **空间位置优化**：起爆点选择在导弹路径前方约2.7公里处，高度1736米，该位置使云团下沉轨迹能最大程度覆盖关键遮蔽窗口。

#### 算法性能分析

- 目标函数调用次数：151,475次
- 总计算时间：2.06秒
- 平均单次评估：0.014毫秒

高效的数值算法使得在合理时间内完成了大规模参数空间搜索。事件驱动的区间计算方法相比均匀采样，在保证精度的同时显著降低了计算复杂度。